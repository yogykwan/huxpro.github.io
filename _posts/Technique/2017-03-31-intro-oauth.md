---
layout:     post
title:      "Intro to OAuth"
subtitle:   ""
date:       2017-03-31
author:     "Jennica"
header-img: "img/post-bg-geek.jpg"
catalog: true
tags:
    - 技术
    - Web
    - 后台
---

# Source
- [Authentication and Authorization](https://cn.udacity.com/course/authentication-authorization-oauth--ud330)

# Project
- [item-catalog](https://github.com/yogykwan/item-catalog) - an application made up of categorized items and user system, where users can manage their own categories and items.

# Pro’s & Con's
- outsource auth handling to OAuth providers
- easy to register users
- choose popular third party account
- keep auth scopes minimal
- limit internet access
- meet different auth requirements

# Web App Flow

## Server Redirect User To OAuth Provider
```
https://oauth2server.com/auth?response_type=code&client_id=CLIENT_ID&redirect_uri=REDIRECT_URI&scope=photos&state=1234zyx
```
* response_type=code - Indicates that your server expects to receive an authorization code
* client_id - The client ID you received when you first created the application
* redirect_uri - Indicates the URI to return the user to after authorization is complete
* scope - One or more scope values indicating which parts of the user's account you wish to access
* state - A random string generated by your application, which you'll verify later

## Provider Redirect User Back To Server 
```
https://oauth2client.com/cb?code=AUTH_CODE_HERE&state=1234zyx
```
* code - The server returns the authorization code in the query string
* state - The server returns the same state value that you passed

## Server Exchanges Code For Access Token From Provider
```
POST https://api.oauth2server.com/token
grant_type=authorization_code&
code=AUTH_CODE_HERE&
redirect_uri=REDIRECT_URI&
client_id=CLIENT_ID&
client_secret=CLIENT_SECRET
```
* grant_type=authorization_code - The grant type for this flow is authorization_code
* code=AUTH_CODE_HERE - This is the code you received in the query string
* redirect_uri=REDIRECT_URI - Must be identical to the redirect URI provided in the original link
* client_id=CLIENT_ID - The client ID you received when you first created the application
* client_secret=CLIENT_SECRET - Since this request is made from server-side code, the secret is included

# Local Permission System
- create schema User to store different users
- accounts with same email go for same row in User
- user can only manage their own items
