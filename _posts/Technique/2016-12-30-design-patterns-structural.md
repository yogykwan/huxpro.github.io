---
layout:     post
title:      "大话设计模式之结构型"
subtitle:   ""
date:       2016-12-28
author:     "Jennica"
header-img: "img/post-bg-patterns.jpg"
catalog: true
tags:
    - 技术
    - 读书
---

# 前言

## 结构型模式
GoF的23种设计模式中，结构型模式是从程序的结构上解决模块之间的耦合问题，共7种：

- 代理模式
- 适配器模式
- 外观模式
- 装饰模式
- 桥接模式
- 享元模式
- 组合模式

## 案例实现

- [《大话设计模式》C++版](https://github.com/yogykwan/design-patterns-cpp)
- [《大话设计模式》Python版](https://github.com/yogykwan/design-patterns-py)

# 代理模式（Proxy）

1. 代理模式：为其他对象提供一种代理以控制对这个对象的访问。实际上是在访问对象时引入一定程度的间接性。
2. 远程代理：为一个对象在不同地址空间提供局部代表，隐藏一个对象存在于不同空间的事实。如.Net加入Web引用，引入WebService，此时项目会生成WebReference的文件夹，就是代理。
3. 虚拟代理：根据需要创建开销很大的对象，通过它存放实例化需很长时间的真实对象。HTML中的多图，就是通过虚拟代理代替了真实图片，存储路径和尺寸。
4. 安全代理：控制真实对象的访问权限，用于对象应该拥有不同的访问权限时。
5. 智能指引：当调用真实对象时，代理处理一些另外的事情。通过代理在访问对象时增加一些内务处理。

# 适配器模式（Adapter）

1. 适配器模式：当系统数据和行为都一致，只有接口不符合时，将一个类的接口转化为客户端期望的另一个接口。
2. 适配器模式用于服用一些现存的类，常用在第三方接口或软件开发后期双方都不易修改的时候。
3. 在.Net中DataAdapter是用于DataSet和数据源间的适配器，Fill更改DataSet适配数据源，Update更改数据源适配DataSet。

# 外观模式（Facade）

1. 外观模式：为子系统中一组接口提供一个一致的界面，即定义一个高层接口，增加子系统的易用性。
2. 外观模式完美体现了依赖倒转原则和迪米特法则。
3. 设计初期阶段，在MVC三层架构中，任意两层间建立外观Facade。
4. 子系统会因不断演化变得复杂，增加外观Facade提供简单简单接口减少依赖。
5. 在维护一个大的遗留系统时，新的开发又必须依赖其部分功能。此时，开发一个外观Facade类，从老系统中抽象出比较清晰的简单接口。让新系统只与Facade交互，而Facade与遗留代码交互所有的工作。

# 装饰模式（Decorator）

1. 装饰模式：动态的给一个对象添加一些额外的职能，把所需功能按顺序串联起来并进行控制。
2. 每个要装饰的功能放在单独的类中，并让这个类包装它所要修饰的对象。当需要执行特殊行为时，客户端就可以根据需要有选择的、有顺序的使用装饰功能包装对象了。
3. 装饰模式有效的把类的核心职能和装饰功能区分开了，并且可以去除相关类中重复的装饰逻辑。

# 桥接模式（Bridge）

1. 对象的继承关系编译时已确定，所以无法在运行时修改从父类继承的实现。由于紧耦合，父类中任何的改变必然会导致子类发生变化。当需要复用子类，但继承下来的方法不合适时，必须重写父类或用其他类替代。这种依赖性限制了灵活性和复用性。
2. 合成／聚合复用原则：尽量使用合成和聚合而不是继承。可以保证每个类封装集中在单个任务上，不会出现规模太大的类及继承结构。
3. 桥接模式：抽象类和其派生类分离，各自实现自己的对象。若系统可以从多角度分类，且每种分类都可能变化，则把多角度分离独立出来，降低耦合。

# 享元模式（Flyweight）

1. 享元模式：运用共享技术有效支持大量细粒度对象。
2. 在享元模式对象内部不随环境改变的共享部分是内部状态，不可共享需要通过调用传递进来的参数是外部状态。
3. 使用享元模式的场景包括，一个应用程序产生了大量的实例对象，占用了大量内存开销；或对象的大多数状态为外部状态，删除内部状态后可以用较少的共享对象来取代组对象。
4. 应用场景有正则表达式、浏览器、机器人指令集等。

# 组合模式（Composite）

1. 组合模式：将对象的组合以树形的层次结构表示，对单个对象和组合结构的操作具有一致性。
2. 透明方法：叶子和分枝对外接口无差别；安全方法：分枝具有添加删除叶子的接口，低层抽象接口和叶子没有。
3. 基本对象组合成组合，组合又可以被组合，不断递归下去，在任何用到基本对象的地方都可以使用组合对象。

# 对比总结

- 代理模式：控制访问；
- 适配器模式：将接口转换为客户端期望的形式；
- 外观模式：整理出一套可用接口；
- 装饰模式：动态修改类的职能；
- 桥接模式：将多角度分类分离独立；
- 享元模式：共享实例；
- 组合模式：递归生成树形结构的组合对象。


---


***转载请注明出处***